# Network Capture Assistant 使用文档

Network Capture Assistant 是一个功能强大的 Chrome 浏览器扩展，旨在帮助开发者和数据采集人员按规则捕获浏览器中的网络请求，并将其详细信息（包括请求头、响应体、性能数据等）实时保存为 JSON 文件。

## 1. 主要功能
- **URL 正则过滤**：支持多条正则规则，精确匹配需要捕获的请求。
- **HTTP 方法筛选**：可针对特定 HTTP 方法（如 POST, GET）进行捕获。
- **实时保存**：匹配的请求会自动实时导出到 Chrome 下载目录，无需手动导出。
- **全量数据采集**：捕获内容涵盖 URL、Headers、Request Body、Response Body 及请求耗时。
- **快捷键支持**：通过键盘快捷键快速开启或关闭捕获功能。

## 2. 安装步骤
由于该插件目前处于开发阶段，请通过以下方式手动安装：

1. 下载或克隆本项目代码到本地。
2. 打开 Chrome 浏览器，访问 `chrome://extensions/`。
3. 开启页面右上角的 **“开发者模式” (Developer mode)**。
4. 点击左上角的 **“加载已解压的扩展程序” (Load unpacked)**。
5. 选择本项目文件夹（包含 `manifest.json` 的文件夹）。
6. 安装成功后，建议将插件固定在工具栏以便快速访问。

## 3. 快速上手

### 3.1 开启捕获
1. 点击插件图标打开弹出面板 (Popup)。
2. 切换 **“捕获状态”** 开关为“开启”。
3. 或者使用快捷键（默认）：
   - **Windows/Linux**: `Ctrl + Shift + K`
   - **macOS**: `Command + Shift + K`

### 3.2 配置文件保存路径
1. 在弹出面板中点击 **“设置”**（或右键插件图标选择“选项”）。
2. 在 **“保存路径”** 输入框中输入子目录名称（例如：`my_captures`）。
   - *注意：由于 Chrome 安全限制，文件只能保存在“下载 (Downloads)”文件夹下，您设置的路径是下载目录下的相对路径。*

### 3.3 配置过滤规则
1. 进入“设置”页面。
2. 在 **“过滤规则”** 区域添加新规则：
   - **正则模式**：输入用于匹配 URL 的正则表达式（例如 `api\.example\.com/v1/.*`）。
   - **HTTP 方法**：选择要捕获的方法（不选则匹配所有）。
   - **启用/禁用**：可随时勾选或取消单条规则。
3. 点击 **“保存设置”** 使规则生效。

## 4. 导出文件说明
匹配成功的请求会自动在下载目录生成 JSON 文件。

- **文件名格式**：`YYYYMMDD_HHMMSS_方法_域名路径简写_状态码_随机ID.json`
- **文件内容包含**：
  - `request`: URL、方法、请求头、请求体。
  - `response`: 状态码、响应头、响应体（Response Body）。
  - `performance`: 请求开始时间、结束时间、总耗时（ms）。
  - `match`: 触发捕获的规则信息。

## 5. 高级配置
在设置页面，您可以精细控制要采集的数据类型：
- **采集请求数据** (Request Headers/Body)
- **采集响应数据** (Response Headers/Body)
- **采集性能数据** (Duration/Timing)

## 6. 常见问题
- **为什么没有捕获到 Response Body？**
  部分跨域请求或流式响应（如长连接、视频流）可能无法被 content script 完整读取。此外，过大的 body 会被插件自动截断以保护浏览器性能。
- **如何修改快捷键？**
  访问 `chrome://extensions/shortcuts` 找到 "Network Capture Assistant"，即可自定义切换开关的快捷键。
- **数据存储配额**
  插件内部会保留最近 1500 条记录的摘要用于面板展示，但实时导出到本地文件的功能不受此限制。

## 7. 开发者备注
本项目基于 Chrome Manifest V3 构建，使用了 `webRequest` API 结合页面脚本注入技术，确保能捕获到大多数 fetch 和 XHR 请求的原始数据。
